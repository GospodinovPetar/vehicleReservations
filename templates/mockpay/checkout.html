{% extends "base.html" %}
{% load static %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/checkout.css' %}">
{% endblock %}

{% block content %}

<div class="pay-card">
  <div class="header">
    <h2 style="margin:0">Checkout</h2>
    <span class="badge">Mock Gateway</span>
  </div>

  {# intent.amount is cents; amount_eur is passed from the view #}
  <p>Pay <span class="amount">{{ amount_eur }}</span> {{ intent.currency }}</p>
  <hr style="border:none;height:1px;background:#e5e7eb;margin:12px 0" />

  {% if form.non_field_errors %}
    <div class="err">{{ form.non_field_errors }}</div>
  {% endif %}

    <form method="post" novalidate>
    {% csrf_token %}

    <div class="field">
      <label for="{{ form.card_number.id_for_label }}">Card number</label>
      {{ form.card_number }}
      {% if form.card_number.errors %}<div class="err">{{ form.card_number.errors|striptags }}</div>{% endif %}
      <div class="hint">Use test numbers (e.g. 4242 4242 4242 4242).</div>
    </div>

    <div class="row">
      <div class="field">
        <label for="{{ form.exp_month.id_for_label }}">Expiry (MM)</label>
        {{ form.exp_month }}
        {% if form.exp_month.errors %}<div class="err">{{ form.exp_month.errors|striptags }}</div>{% endif %}
      </div>
      <div class="field">
        <label for="{{ form.exp_year.id_for_label }}">Expiry (YY)</label>
        {{ form.exp_year }}
        {% if form.exp_year.errors %}<div class="err">{{ form.exp_year.errors|striptags }}</div>{% endif %}
      </div>
    </div>

    <div class="row">
      <div class="field wide">
        <label for="{{ form.cardholder_name.id_for_label }}">Name on card</label>
        {{ form.cardholder_name }}
        {% if form.cardholder_name.errors %}<div class="err">{{ form.cardholder_name.errors|striptags }}</div>{% endif %}
      </div>
      <div class="field narrow">
        <label for="{{ form.cvc.id_for_label }}">CVC</label>
        {{ form.cvc }}
        {% if form.cvc.errors %}<div class="err">{{ form.cvc.errors|striptags }}</div>{% endif %}
      </div>
    </div>

    <div class="row">
      <div class="field">
        <label for="{{ form.billing_country.id_for_label }}">Country</label>
        {{ form.billing_country }}
        {% if form.billing_country.errors %}<div class="err">{{ form.billing_country.errors|striptags }}</div>{% endif %}
      </div>
      <div class="field">
        <label for="{{ form.billing_postal.id_for_label }}">ZIP / Postal code</label>
        {{ form.billing_postal }}
        {% if form.billing_postal.errors %}<div class="err">{{ form.billing_postal.errors|striptags }}</div>{% endif %}
      </div>
    </div>

    <div class="field">
      <label for="{{ form.outcome.id_for_label }}">Simulate outcome</label>
      {{ form.outcome }}
    </div>

    <div class="row" style="justify-content:flex-end;gap:8px">
      <a class="btn secondary" href="{% url 'inventory:reservations' %}">Back</a>
      <button class="btn" type="submit">Pay now</button>
    </div>
  </form>
</div>
{% endblock %}